<!-- <view class="fixed-holder" wx:if="{{breadLi.length>0 && cakeLi.length>0}}">
  <view class="tips flex">
    <text class="iconfont icon-notice"></text> 
    <view class="txt flex-1">
      <text>{{instructions}}</text>
      <text>{{instructions}}</text>
    </view>
  </view>
</view> -->

<view class="pro-box" wx:if="{{breadLi.length>0}}">
  <view class="hd flex" bind:tap="selectAll" data-type="1">
    <view class="checkbox {{noallBread?'':'on'}}">
      <view class="iconfont icon-check"></view>
    </view>
    <text>面包</text>
  </view>
  <view class="pro-tip" bind:tap="showNotice"><text class="tag">免邮</text>{{special_tips[0].title}}{{hasActive?'，'+special_tips[1].title:''}}</view>
  <view class="pro-list">
    <movable-area class="item bread-item" wx:for="{{breadLi}}" wx:for-index="index">
      <movable-view damping="50" x="{{item.txtStyle}}" class="move-area" direction="horizontal" out-of-bounds="false" friction="50">
        <view class="item-wrap flex-center item_{{item.cart_id}}" bindtouchstart="touchstart" bindtouchend="touchE" data-idx="{{index}}" data-type="1" data-id="{{item.cart_id}}">
          <view class="checkbox {{item.is_selected=='1'?'on':''}}" bind:tap="select" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="1" data-id="{{item.cart_id}}">
            <view class="iconfont icon-check"></view>
          </view>
          <view class="pro-info flex flex-1 {{item.has_stock==0?'sold-out':''}}">
            <view class="pic" bind:tap="toProInfo" data-isfit="{{item.is_fittings}}" data-proid="{{item.sku_id}}" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="1" data-id="{{item.cart_id}}">
              <view class="tag">已售罄</view>
              <image src="{{item.sku_image_url}}" mode="aspectFill"></image>
            </view>
            <view class="txt flex-1 flex">
              <view class="tit flex-center" bind:tap="toProInfo" data-isfit="{{item.is_fittings}}" data-proid="{{item.sku_id}}" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="1" data-id="{{item.cart_id}}"><text class="tag" wx:if="{{item.special_tag}}">{{item.special_tag}}</text><text>{{item.sku_name}}</text></view>
              <view class="tag flex" wx:if="{{item.weight}}">
                <text>约{{item.weight}}</text>
              </view>
              <view class="price flex" wx:if="{{item.has_stock!=0}}">
                <view class="num">￥<text>{{item.sku_price}}</text></view>
                <view class="set-chart flex">
                  <text class="iconfont icon-minus {{item.sku_number==1?'one':''}}" data-skuid="{{item.sku_id}}" catch:tap="minusNum" data-type="1"
                    data-idx="{{index}}" data-num="{{item.sku_number}}"></text>
                  <text class="count">{{item.sku_number}}</text>
                  <text class="iconfont icon-plus" data-skuid="{{item.sku_id}}" catch:tap="plusNum" data-type="1"
                    data-idx="{{index}}"></text>
                </view>
              </view>
              <view class="price" wx:else>该商品已售罄</view>
            </view>
          </view>
          <view class="pro-option flex">
            <view class="chartdel" data-skuid="{{item.sku_id}}" data-type="1" data-id="{{item.cart_id}}" catch:tap="delPro">删除</view>
          </view>
        </view>
      </movable-view>
    </movable-area>
  </view>
</view>
<view class="pro-box" wx:if="{{cakeLi.length>0}}">
  <view class="hd flex" bind:tap="selectAll" data-type="2">
    <view class="checkbox {{noallCake?'':'on'}}">
      <view class="iconfont icon-check"></view>
    </view>
    <text>蛋糕</text>
  </view>
  <view class="pro-tip"><text class="tag">免邮</text>{{tipsCake}}</view>
  <view class="pro-list cakeList">
    <movable-area class="item cake-item" wx:for="{{cakeLi}}" wx:for-index="index">
      <movable-view damping="50" x="{{item.txtStyle}}" class="move-area" direction="horizontal" out-of-bounds="false" friction="50">
        <view class="item-wrap flex-center item_{{item.cart_id}}" bindtouchstart="touchstart" bindtouchend="touchE" data-idx="{{index}}" data-type="2" data-id="{{item.cart_id}}">
          <view class="checkbox {{item.is_selected=='1'?'on':''}}" bind:tap="select" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="2" data-id="{{item.cart_id}}">
            <view class="iconfont icon-check"></view>
          </view>
          <view class="pro-info flex flex-1 {{item.has_stock==0?'sold-out':''}}">
            <view class="pic" bind:tap="toProInfo" data-isfit="{{item.is_fittings}}" data-proid="{{item.spu_id}}" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="2" data-id="{{item.cart_id}}">
              <view class="tag">已售罄</view>
              <image src="{{item.sku_image_url}}" mode="aspectFill"></image>
            </view>
            <view class="txt flex-1 flex">
              <view class="tit" bind:tap="toProInfo" data-isfit="{{item.is_fittings}}" data-proid="{{item.spu_id}}" data-stock="{{item.has_stock}}" data-idx="{{index}}" data-type="2" data-id="{{item.cart_id}}"><text class="tag" wx:if="{{item.special_tag}}">{{item.special_tag}}</text>{{item.sku_name}} {{item.sku_unit}}</view>
              <view class="tag flex" wx:if="{{item.is_fittings==0}}">
                <text wx:if="{{item.size}}">{{item.size}}</text>
                <text wx:if="{{item.edible}}">{{item.edible}}</text>
                <text wx:if="{{item.use_fittings}}">{{item.use_fittings}}</text>
              </view>
              <view class="price flex" wx:if="{{item.has_stock!=0}}">
                <view class="num">￥<text>{{item.sku_price}}</text></view>
                <view class="set-chart flex">
                  <text class="iconfont icon-minus {{item.sku_number==1?'one':''}}" data-skuid="{{item.sku_id}}" data-spuid="{{item.spu_id}}" catch:tap="minusNum" data-type="2"
                    data-idx="{{index}}" data-num="{{item.sku_number}}"></text>
                  <text class="count">{{item.sku_number}}</text>
                  <text class="iconfont icon-plus" data-skuid="{{item.sku_id}}" data-spuid="{{item.spu_id}}" catch:tap="plusNum" data-type="2"
                    data-idx="{{index}}"></text>
                </view>
              </view>
              <view class="price" wx:else>该商品已售罄</view>
            </view>
          </view>
          <view class="pro-option flex">
            <view class="del chartdel" data-skuid="{{item.sku_id}}" data-id="{{item.cart_id}}" data-spuid="{{item.spu_id}}" catch:tap="delPro">删除</view>
          </view>
        </view>
      </movable-view>
    </movable-area>
  </view>
</view>
<view class="pro-box">
  <view class="fittings" wx:if="{{fittingsList.length>0}}">
    <view class="hd flex-center" bind:tap="showTip"><text>蛋糕配件</text> (不可食用)<text class="iconfont icon-notice2"></text></view>
    <scroll-view scroll-x="{{true}}">
      <view class="flex list">
        <view class="item fit-item" wx:for="{{fittingsList}}" catch:tap="selectFittings" data-idx="{{index}}"
          data-id="{{item.sku}}">
          <view class="pic">
            <image src="{{item.img}}"></image>
            <text class="remark" wx:if="{{item.remark}}">{{item.remark}}</text>
          </view>
          <view class="tit">{{item.name}}</view>
          <view class="price flex">
            <view class="num">￥<text>{{item.price}}</text></view>
            <view class="add iconfont icon-add"></view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>
<view class="nodata" wx:if="{{breadLi.length==0 && cakeLi.length==0}}">
  <view>
    <image src="../../../image/no-pro.png"></image>
  </view>
  <view class="txt">购物车还是空的</view>
  <navigator url="/pages/proList/proList" open-type="switchTab" class="btn">去逛逛</navigator>
</view>
<view class="ios-padding option-wp">
  <view class="option flex-center" wx:if="{{breadLi.length>0 || cakeLi.length>0}}">
    <!-- <view class="select flex-center">
      <view class="checkbox">
        <view class="iconfont icon-check"></view>
      </view>
      <text>全选</text>
    </view> -->
    <view class="price flex">
      <view class="flex-center"><text>合计：</text>
        <view class="num">￥<text>{{totalPrice}}</text></view>
      </view>
      <view class="buy-btn" bind:tap="Settlement">去结算 <text >({{cakeSelectedNum+breadSelectedNum}})</text></view>
    </view>
  </view>
</view>



<view class="pop-panel btm-panel score-panel {{pop=='fittings-panel'?'upPanel':''}}" catch:touchmove="{{true}}">
  <view class="iconfont icon-close close" bind:tap="close"></view>
  <view class="pop-con">
    <view class="info flex">
      <view class="pic">
        <image src="{{fitting.img}}"></image>
      </view>
      <view class="h3 flex">
        <view class="tit">{{fitting.name}}</view>
        <view class="remark">{{fitting.remark}}</view>
        <view class="price"><text>￥</text>{{fitting.price}}</view>
      </view>
    </view>
    <view class="h4"><text>选择规格</text></view>
    <view class="fitting-list flex">
      <view class="{{key==fitting.sku?'on':''}}" wx:for="{{fitting.sku_list}}" wx:for-index="key" data-sku="{{key}}"
        bind:tap="selectFittingSku">{{item}}</view>
    </view>
    <view class="h4 flex">
      <text>购买数量</text>
      <view class="set-chart flex">
        <text class="iconfont icon-minus {{skuNum==1?'one':''}}" bind:tap="minusFitting" data-type="2" data-idx="{{index}}"></text>
        <text class="count">{{skuNum}}</text>
        <text class="iconfont icon-plus" bind:tap="addFitting" data-type="2" data-idx="{{index}}"></text>
      </view>
    </view>
    <block wx:if="{{fitting.basic}}">
      <view class="h4">
        <text>配件说明</text>
      </view>
      <scroll-view scroll-y="{{true}}" class="basic">
        <view wx:for="{{fitting.basic}}"><text>{{index}}</text>：{{fitting.basic[index]}}</view>
      </scroll-view> 
    </block>
    
    <view class="confirm-btn btn" bind:tap="confirmFitting" style="margin-bottom:{{btmHolder}}px" data-sku="{{fitting.sku}}">确定</view>
  </view>

</view>

<view class="pop-panel btm-panel order-panel {{pop=='order-panel'?'upPanel':''}}">
  <view class="iconfont icon-close close" bind:tap="close"></view>
  <view class="title">请选择结算商品</view>
  <view class="tips">{{instructions}}</view>
  <view class="pop-con" style="padding-bottom:{{btmHolder}}px">
    
    <view class="item" wx:if="{{breadSelectedNum>0}}">
      <view class="h3">面包结算</view>
      <view class="flex-center" >
      <scroll-view scroll-x="{{true}}" class="pic-box flex-1">
        <view class="flex">
          <view class="pic" wx:for="{{breadLi}}" wx:if="{{item.is_selected==1}}">
            <image src="{{item.sku_image_url}}" mode="aspectFill"></image>
            <view class="count">X{{item.sku_number}}</view>
          </view>
          
        </view>
      </scroll-view>
      <view class="charge" bind:tap="getOrder" data-type="1">去结算</view>
      </view>
      <view class="info" wx:if="{{breadSelectedNum>0}}">共<text class="color-b"> {{breadSelectedNum}} </text>件，合计：<text class="color-b">{{breadSelectedPrice}}</text></view>
      
    </view>
    <view class="item" wx:if="{{cakeSelectedNum>0}}">
      <view class="h3">蛋糕结算</view>
      <view class="flex-center" >
        <scroll-view scroll-x="{{true}}" class="pic-box flex-1">
          <view class="flex">
            <view class="pic" wx:for="{{cakeLi}}" wx:if="{{item.is_selected==1}}">
              <image src="{{item.sku_image_url}}" mode="aspectFill"></image>
              <view class="count">X{{item.sku_number}}</view>
            </view>
            
          </view>
        </scroll-view>
        <view class="charge" bind:tap="getOrder" data-type="2">去结算</view>
      </view>
      <view class="info" wx:if="{{cakeSelectedNum>0}}">共<text class="color-b"> {{cakeSelectedNum}} </text>件，合计：<text class="color-b">{{cakeSelectedPrice}}</text></view>
    </view>
    
  </view>

</view>

<view class="pop-panel btm-panel tip-panel {{pop=='tip-panel'?'upPanel':''}}" style="padding-bottom:{{btmHolder}}px">
  <view class="iconfont icon-close close" bind:tap="close"></view>
  <view class="pop-con">
    <view class="tit">优惠</view>
    <view class="tip-item"><view class="h4 flex">{{special_tips[0].title}}</view><view class="txt">{{special_tips[0].desc}}</view></view>
    <view class="tip-item" wx:if="{{hasActive}}"><view class="h4 flex">{{special_tips[1].title}}</view><view class="txt">{{special_tips[1].desc}}</view></view>
    <view class="confirm-btn btn" bind:tap="close">知道了</view>
  </view>

</view>

<view class="mask" catch:touchmove="{{true}}" wx:if="{{pop!=0}}" bind:tap="close"></view>
<view style="height:{{50+btmHolder}}px"></view>