<!-- index.wxml -->
<wxs module="filter" src="../../utils/tools.wxs"></wxs>
<navBar hasAddress cityName="{{addressInfo}}" wx:if="{{showNav}}"></navBar>
<!-- <view class="bannerBg">
  <image src="{{curBg}}" mode="bottom"></image>
</view> -->
<view class="notice {{panel=='notice'?'show':''}}" bindtap="showNotice" style="top:{{fixedTop}}px"
  wx:if="{{notice.length>0}}">
  <view class="txt flex" wx:if="{{panel!='notice'}}">
    <swiper autoplay="{{playnotice}}" circular vertical >
      <block wx:for="{{notice}}" wx:for-index="index">
        <swiper-item catchtouchmove='catchTouchMove'>
          <view class="text-overflow"><text class="iconfont icon-notice"></text> {{item}}</view>
        </swiper-item>
      </block>
    </swiper>
    <view class="flex-center show-btn">
      <view>更多</view>
      <text class="iconfont icon-arrow-btm"></text>
    </view>
  </view>
  <view class="tit flex" wx:if="{{panel=='notice'}}" catch:tap="closePanel">
    <text>最新通知</text>
    <view class="flex-center show-btn">
      <view>收起</view>
      <text class="iconfont icon-arrow-btm"></text>
    </view>
  </view>
  <scroll-view show-scrollbar="{{false}}" enhanced="{{true}}" scroll-y="{{true}}" class="notice-panel">
    <view style="padding:0 24rpx 24rpx 24rpx;">
      <block wx:for="{{notice}}" wx:for-index="index">
        <view class="item"><text>◉</text> {{item}}</view>
      </block>
    </view>

    <!-- <view class="icon-close" catch:tap="closePanel"></view> -->
  </scroll-view>
</view>

<!-- 开始 -->
<view class="wrap" style="padding-top:{{notice.length>0 ? fixedTop+30:fixedTop}}px;">
  <scroll-view scroll-y="true" class="contain" refresher-default-style="white" bindscroll="scroll" scroll-top="{{pos}}"
    bindrefresherrefresh="refresh">
    <!-- 组件部分 -->
    <block wx:for="{{components}}" wx:for-index="index">
      <!-- 轮播图 -->
      <view class="banner flex" wx:if="{{item.block_type == 4}}">
        <swiper interval="{{interval}}" autoplay="{{true}}" duration="{{duration}}" circular="{{circular}}"
          indicator-dots indicator-active-color="#C1996B">
          <block wx:for="{{banner}}" wx:for-index="index">
            <swiper-item>
              <view data-url="{{item.url}}" data-type="{{item.url_type}}" bind:tap="toPro">
                <image src="{{item.image_url}}" mode="aspectFill" class="slide-image" />
              </view>
            </swiper-item>
          </block>
        </swiper>
      </view>

      <!-- 图文导航 -->
      <view class="menu flex-center" wx:if="{{item.block_type == 3}}">
        <view hover-class="none" wx:for="{{menu}}" bind:tap="toPro" data-url="{{item.url}}"
          data-type="{{item.url_type}}">
          <image src="{{item.image_url}}"></image>
        </view>
      </view>

      <!-- 分类推荐 -->
      <view class='main-content'>
        <view class='pro-block block3' wx:if="{{item.block_type == 2}}">
          <view class="title flex">
            <block  wx:if="{{item.componentDetail.box_style.background_image != ''}}">
              <view style="height:34rpx"><image src="{{item.componentDetail.box_style.background_image}}" mode="heightFix"></image></view>
            </block>
            <block wx:elif="{{item}}">
              <view style="height:34rpx" mode="heightFix"><image src=""></image></view>
            </block>
            
          
            <view wx:if="{{item.componentDetail.link_type >0 }}" class="more" bind:tap="toPro"
              data-url="{{item.componentDetail.link_type}}" data-type="4">查看更多<text
                class="iconfont icon-arrow-r"></text></view>
          </view>

          <view class="pro-list">
            <block wx:for="{{item.componentDetail.imageReader}}">
              <view hover-class="none" bind:tap="toPro" data-url="{{item.url}}" data-type="{{item.url_type}}">
                <view class="pic">
                  <image src="{{item.image_url}}"></image>
                </view>
              </view>
            </block>
          </view>
        </view>
      </view>
    </block>

    <view class="logo">
      <image src="../../image/logo.png"></image>
    </view>
    <view class="gotop" bindtap="gotop" wx:if="{{showGoto}}">
      <image src="../../image/icon-top.png"></image>
    </view>
    <!-- <view style="height:{{50+btmHolder}}px"></view> -->
  </scroll-view>

</view>
<view class="mask" style="top:{{fixedTop}}px" wx:if="{{mask}}" catchtap="closePanel"></view>